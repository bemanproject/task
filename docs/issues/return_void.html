<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<style>
  ins {background-color:#A0FFA0}
  del {background-color:#FFA0A0}
</style>
<title>task::promise_type::return_void/value lack a specification</title>
</head>
<body>
<h3><code>task::promise_type::return_void/value</code> lack a specification</h3>
<p><b>Section:</b> 33.13.6.5 <a href="https://wg21.link/task.promise">[task.promise]</a></p>
<p><b>Submitter:</b> Dietmar K&uuml;hl</p>
<p><b>Discussion:</b></p>
<p>
The synopsis for <code>std::execution::task&lt;T, E&gt;::promise_type</code> declares <code>return_void()</code> or <code>return_value(V&amp;&amp;)</code>. However, there is no specification of what these functions actually do. <code>return_void()</code> doesnâ€™t need to do anything at all. <code>return_value(V&amp;&amp; v)</code> needs to store <code>v</code> into the <code><i>result</i></code>.
</p>
<p><b>Proposed resolution:</b></p>
<p>
Insert the following paragraphs after the specification of <code>unhandled_stopped</code>:
</p>
<blockquote>
<pre>coroutine_handle&lt;&gt; unhandled_stopped();</pre>
<p>-13- <i>Effects</i>: Completes the asynchronous operation associated with <code><i>STATE</i>(*this)</code> by invoking <code>set_stopped(std::move(<i>RCVR</i>(*this)))</code>.</p>
<p>-14- <i>Returns</i>: <code>noop_coroutine()</code>.</p>
<pre><ins>void return_void();</ins></pre>
<p><ins>-15- <i>Effects</i>: does nothing.<ins></p>
<pre><ins>
template&lt;class V&gt;
  void return_value(V&amp;&amp v);
</ins></pre>
<p><ins>-16- <i>Effects</i>: Equivalent to <code><i>result</i>.emplace(std::forward&lt;V&gt;(v)).</ins></p>
<pre>unspecified get_env() const noexcept;</pre>
<p>-1<del>5</del><ins>7</ins>- <code>Returns</i>: An object <code>env</code> such that queries are forwarded as follows:</p>
</blockquote>
</body>
</html>
